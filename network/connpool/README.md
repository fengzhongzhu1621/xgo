## 背景

客户端请求服务端，如果是以 tcp 协议进行通信的话，需要考虑三次握手建立连接的开销。通常情况下 tcp 通信模式会预先建立好连接，或者发起请求时建立好连接，这里的连接用完之后不会直接 close 掉，而是会被后续复用。  
连接池就是为了实现此功能而进行的一定程度的封装。

## 原理

pool 维护一个 sync.Map 作为连接池，key 为<network, address, protocol>编码，value 为与目标地址建立的连接构成的 ConnectionPool, 其内部以一个链表维护空闲连接。在短连接模式中，transport 层会在 rpc 调用后关闭连接，而在连接池模式中，会把使用完的连接放回连接池，以待下次需要时取出。  
为实现上述目的，连接池需要具备以下功能：
- 提供可用连接，包括创建新连接和复用空闲连接；
- 回收上层使用过的连接作为空闲连接管理；
- 对连接池中空闲连接的管理能力，包括复用连接的选择策略，空闲连接的健康监测等；
- 根据用户配置调整连接池运行参数。
