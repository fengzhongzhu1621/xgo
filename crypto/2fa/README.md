# 2FA
2FA（Two-Factor Authentication，双因素认证）

两步验证要求用户提供两种不同形式的身份验证，使用2FA可以大大增加账户的安全性，因为即使攻击者获取了用户的密码，没有第二个验证因素，他们也无法访问账户.

* 知识因素：用户知道的信息（如密码）
* 所有权因素：用户拥有的设备（如手机）
* 生物特征因素：用户的生物特征（如指纹）

# TOTP
基于时间的一次性密码（Time-based One-Time Password，TOTP）是HOTP（基于事件的一次性密码）的一种变种，它引入了时间作为动态因素。 TOTP算法使用一个秘密密钥和当前时间来生成一次性密码。这个密码每30秒（或者配置的其他时间段）就会变化，因此即便泄露，效用也很短暂。

TOTP遵循RFC 6238标准，并且通常用于实现2FA。每个TOTP都是通过以下步骤生成的

* 取得当前时间戳。
* 将时间戳向下取整到最接近的30秒间隔（这是默认的时间步长，但可以调整）。
* 对这个时间值应用HMAC-SHA1算法，使用预先共享的秘密密钥作为密钥。
* 对HMAC结果进行动态截断以得到一个固定长度的数字串（通常是6位数）。
* 将这个数字串作为一次性密码。

TOTP 工作流程详解

* 客户端和服务端共享一个密钥（通常通过二维码生成并扫描）。
* 使用 HMAC-SHA1 算法计算哈希值。
* 将时间戳与共享密钥结合，生成动态密码。
* 服务端验证生成的密码是否匹配。
* 如果匹配，则允许用户登录。
