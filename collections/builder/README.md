# Builder 模式 和 Option 模式的对比

| **对比维度**       | **Option 模式（函数式选项模式）**                                                                 | **Builder 模式**                                                                 |
|--------------------|-------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
| **核心思想**       | 通过可变参数的函数选项（`func(*T)`）灵活配置对象，避免构造函数参数爆炸。                          | 将复杂对象的构建过程分解为多个步骤，逐步构建对象，封装构建逻辑。                |
| **代码结构**       | - 一个 `Option` 函数类型（`func(*T)`）<br>- 多个具体的 `Option` 函数（如 `WithName`）<br>- 构造函数接收 `...Option` 参数 | - 一个 `Builder` 结构体<br>- 多个 `WithXxx` 方法（链式调用）<br>- `Build` 方法生成最终对象 |
| **使用方式**       | ```go<br>obj := NewObj(WithA(1), WithB("x"))<br>```                                             | ```go<br>builder := NewBuilder()<br>obj := builder.WithA(1).WithB("x").Build()<br>``` |
| **优点**           | 1. 代码简洁，无需额外结构体<br>2. 灵活配置，支持零个或多个选项<br>3. 扩展性强（新增选项不影响旧代码） | 1. 构建过程清晰，逐步设置字段<br>2. 可在构建过程中验证或修改状态<br>3. 适合复杂对象的构建 |
| **缺点**           | 1. 无法在构建过程中验证或修改状态<br>2. 需要理解函数式选项的概念<br>3. 构建逻辑分散在多个 `Option` 函数中 | 1. 需要定义额外的 `Builder` 结构体<br>2. 构建过程可能引入中间对象<br>3. 代码量稍多 |
| **适用场景**       | - 参数较多或可选参数较多的简单对象<br>- 需要快速配置且无需复杂构建逻辑的对象<br>- 希望代码简洁的场景       | - 构建过程复杂（如多步骤、多组件）<br>- 需要在构建过程中验证或修改状态<br>- 需要逐步构建对象的场景 |
| **内存开销**       | 无额外内存开销（直接操作目标对象）                                                                | 需要额外的 `Builder` 结构体内存                                            |
| **扩展性**         | 新增选项只需添加新的 `Option` 函数，不影响现有代码                                                | 新增构建步骤需修改 `Builder` 结构体和方法                                  |
| **典型应用**       | - 配置结构体（如数据库连接配置、HTTP客户端配置）<br>- 简单对象的灵活初始化                          | - 复杂对象构建（如数据库连接池、GUI组件、游戏角色）<br>- 需要逐步验证的场景   |
| **代码可读性**     | 高（链式调用直观）                                                                                | 高（逐步构建清晰）                                                         |
| **维护成本**       | 低（新增选项简单）                                                                                | 中（需维护 `Builder` 结构体）                                              |
